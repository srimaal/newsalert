<script>
    // Fetch the news data from the JSON file
    fetch('https://srimaal.github.io/newsalert/news.json')  // Update this URL with your actual repository details
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to load news.json');
            }
            return response.json();
        })
        .then(newsItems => {
            let currentNewsIndex = 0;
            let charIndex = 0;
            const newsContainer = document.getElementById("news-container");
            const newsImage = document.getElementById("news-image");
            const typingSpeed = 100;
            const pauseBetweenNews = 2000;
            const defaultImageUrl = "https://cdn.pixabay.com/photo/2022/11/04/09/29/breaking-news-7569437_1280.jpg"; // Default image URL

            // Type news with typewriter effect
            function typeNews() {
                if (newsItems.length === 0) {
                    newsContainer.textContent = "No news items available. Please add news in the CMS.";
                    return;
                }

                const currentItem = newsItems[currentNewsIndex];
                // Use default image if no image URL is provided
                newsImage.src = currentItem.imageUrl || defaultImageUrl;
                newsImage.style.display = currentItem.imageUrl || defaultImageUrl ? 'block' : 'none';

                if (charIndex < currentItem.text.length) {
                    newsContainer.textContent += currentItem.text.charAt(charIndex);
                    charIndex++;
                    adjustFontSize();
                    setTimeout(typeNews, typingSpeed);
                } else {
                    setTimeout(() => {
                        charIndex = 0;
                        newsContainer.textContent = "";
                        currentNewsIndex = (currentNewsIndex + 1) % newsItems.length;
                        typeNews();
                    }, pauseBetweenNews);
                }
            }

            // Adjust font size to fit the container
            function adjustFontSize() {
                const containerWidth = newsContainer.clientWidth;
                let fontSize = 24; // Base font size
                newsContainer.style.fontSize = `${fontSize}px`;

                while (newsContainer.scrollWidth > containerWidth && fontSize > 12) {
                    fontSize--;
                    newsContainer.style.fontSize = `${fontSize}px`;
                }
            }

            // Start typing the first news item
            typeNews();

            // Auto-refresh every 4 minutes (240,000 milliseconds)
            setTimeout(() => {
                location.reload();
            }, 240000); // 4 minutes in milliseconds
        })
        .catch(error => {
            console.error('Error fetching news:', error);
            document.body.innerHTML = "<h1>Error loading news. Please check your connection or try again later.</h1>";
        });
</script>
